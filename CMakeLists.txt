#
# \file CMakeLists.txt
#
# \author Martin-Pierrat Louis (mart_p)
#
# \date Sat, 16 Jan 2016 20:31:02
#
# \version 1.0.0
#
# CMakeList used to generate the Engine library.
#


## CMAKE INITIALISATION

PROJECT(Engine)
CMAKE_MINIMUM_REQUIRED(VERSION 2.8.12)
SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake/cmake_modules")

## END CMAKE INITIALISATION



## PROJECT VERSION

SET(PROJECT_VERSION_MAJOR 2)
SET(PROJECT_VERSION_MINOR 1)
SET(PROJECT_VERSION_PATCH 0)
SET(PROJECT_VERSION_EXTRA 0)

SET(PROJECT_VERSION ${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}.${PROJECT_VERSION_PATCH})
SET(PROJECT_VERSION_FULL ${PROJECT_VERSION}.${PROJECT_VERSION_EXTRA})

SET(RESOURCES_PATH "${CMAKE_SOURCE_DIR}/resources")

CONFIGURE_FILE(
    "${CMAKE_SOURCE_DIR}/sources/Engine/Version.hpp.in"
    "${CMAKE_SOURCE_DIR}/sources/Engine/Version.hpp"
    )

CONFIGURE_FILE(
    "${CMAKE_SOURCE_DIR}/sources/Engine/Configuration.hpp.in"
    "${CMAKE_SOURCE_DIR}/sources/Engine/Configuration.hpp"
    )

## END PROJECT VERSION



## PROJECT LANGUAGE

ENABLE_LANGUAGE(CXX)

## END PROJECT LANGUAGE



## FIND LIBRARY DEPENDENCY

FIND_PACKAGE(OpenGL REQUIRED)
FIND_PACKAGE(GLEW REQUIRED)
FIND_PACKAGE(Devil REQUIRED)
FIND_PACKAGE(Assimp REQUIRED)
FIND_PACKAGE(Log4cpp REQUIRED)
FIND_PACKAGE(RapidXml REQUIRED)

## END FIND LIBRARY DEPENDENCY


## PROJECT SOURCES FILES

SET(ENGINE_SOURCES_DIR ${CMAKE_SOURCE_DIR}/sources/Engine/)
SET(CORE_ENGINE_SOURCES_DIR ${ENGINE_SOURCES_DIR}/Core/)

SET(ENGINE_SOURCES_FILES
    ${ENGINE_SOURCES_DIR}/Core.cpp
    )

SET(CORE_ENGINE_SOURCES_FILES
    ${CORE_ENGINE_SOURCES_DIR}/Animation.cpp
    ${CORE_ENGINE_SOURCES_DIR}/AnimationLibrary.cpp
    ${CORE_ENGINE_SOURCES_DIR}/ArrayObject.cpp
    ${CORE_ENGINE_SOURCES_DIR}/AssimpImporter.cpp
    ${CORE_ENGINE_SOURCES_DIR}/AssimpScene.cpp
    ${CORE_ENGINE_SOURCES_DIR}/BufferObject.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Camera.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Clock.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Entity.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Light.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Material.cpp
    ${CORE_ENGINE_SOURCES_DIR}/MaterialLibrary.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Mesh.cpp
    ${CORE_ENGINE_SOURCES_DIR}/MeshLibrary.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Object.cpp
    ${CORE_ENGINE_SOURCES_DIR}/PerspectiveCamera.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Renderer.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Scene.cpp
    ${CORE_ENGINE_SOURCES_DIR}/SceneGraph.cpp
    ${CORE_ENGINE_SOURCES_DIR}/SceneGraphNode.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Shader.cpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderLibrary.cpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderProgram.cpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderProgramLibrary.cpp
    ${CORE_ENGINE_SOURCES_DIR}/SpatialGraph.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Texture.cpp
    ${CORE_ENGINE_SOURCES_DIR}/TextureLibrary.cpp
    ${CORE_ENGINE_SOURCES_DIR}/Transform.cpp
    )

SET(PROJECT_SOURCES_FILES
    ${ENGINE_SOURCES_FILES}
    ${CORE_ENGINE_SOURCES_FILES}
    )

## END PROJECT SOURCES FILES



## PROJECT INCLUDES DIRECTORIES

SET(PROJECT_INCLUDE_DIR ${CMAKE_SOURCE_DIR}/sources/)

INCLUDE_DIRECTORIES(
    ${PROJECT_INCLUDE_DIR}
    ${OPENGL_INCLUDE_DIR}
    ${GLEW_INCLUDE_DIRS}
    ${ASSIMP_INCLUDE_DIR}
    ${DevIL_INCLUDE_DIR}
    ${LOG4CPP_INCLUDE_DIR}
    )

## END PROJECT INCLUDES DIRECTORIES



## PROJECT HEADERS FILES

SET(CORE_ENGINE_SOURCES_DIR ${ENGINE_SOURCES_DIR}/Core/)

SET(CORE_ENGINE_HEADERS_FILES
    ${CORE_ENGINE_SOURCES_DIR}/Animation.hpp
    ${CORE_ENGINE_SOURCES_DIR}/AnimationLibrary.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ArrayObject.hpp
    ${CORE_ENGINE_SOURCES_DIR}/AssimpImporter.hpp
    ${CORE_ENGINE_SOURCES_DIR}/AssimpScene.hpp
    ${CORE_ENGINE_SOURCES_DIR}/BufferObject.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Camera.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Clock.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Entity.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Library.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Library.tpp
    ${CORE_ENGINE_SOURCES_DIR}/Light.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Material.hpp
    ${CORE_ENGINE_SOURCES_DIR}/MaterialLibrary.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Mesh.hpp
    ${CORE_ENGINE_SOURCES_DIR}/MeshLibrary.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Object.hpp
    ${CORE_ENGINE_SOURCES_DIR}/PerspectiveCamera.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Renderer.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Scene.hpp
    ${CORE_ENGINE_SOURCES_DIR}/SceneGraph.hpp
    ${CORE_ENGINE_SOURCES_DIR}/SceneGraphNode.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Shader.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderLibrary.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderMapping.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderNames.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderProgram.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderProgramLibrary.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderProgramMapping.hpp
    ${CORE_ENGINE_SOURCES_DIR}/ShaderProgramNames.hpp
    ${CORE_ENGINE_SOURCES_DIR}/SpatialGraph.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Texture.hpp
    ${CORE_ENGINE_SOURCES_DIR}/TextureLibrary.hpp
    ${CORE_ENGINE_SOURCES_DIR}/Transform.hpp
    )

SET(ENGINE_HEADERS_FILES
    ${ENGINE_SOURCES_DIR}/Configuration.hpp
    ${ENGINE_SOURCES_DIR}/Version.hpp
    ${ENGINE_SOURCES_DIR}/Core.hpp
    )

SET(PROJECT_HEADERS_FILES
    ${ENGINE_HEADERS_FILES}
    ${CORE_ENGINE_HEADERS_FILES}
    )

## END PROJECT HEADERS FILES



## PROJECT SETTINGS

IF (CMAKE_BUILD_TYPE MATCHES "debug")

    SET(CMAKE_CXX_FLAGS_DEBUG ${CMAKE_CXX_FLAGS_DEBUG} -D__DEBUG__)
    SET(LIBRARY_OUTPUT_PATH ${CMAKE_SOURCE_DIR}/build/debug/)

ELSE ()

    SET(LIBRARY_OUTPUT_PATH ${CMAKE_SOURCE_DIR}/build/release)

ENDIF ()

## END PROJECT SETTINGS



## COMPILATION SETTINGS

#if (WIN32)
    #if (MSVC)
    #elseif(CMAKE_COMPILER_IS_GNUCXX)
    ## SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -mwindows")
    ## # Not tested
    #else()
    #message(SEND_ERROR "You are using an
    #unsupported Windows compiler! (Not MSVC or GCC)")
    #endif()
#elseif (UNIX)
    #set(CMAKE_PREFIX_PATH "/usr/lib64/qt5")
    SET(CMAKE_CXX_FLAGS "-std=c++14 -W -Wall -Wextra")
#else ()
    #message(SEND_ERROR "You are on an unsupported platform! (Not Win32 or Unix)")
#ENDIF ()

## END COMPILATION SETTINGS



## BINARY SETTINGS

ADD_LIBRARY(${CMAKE_PROJECT_NAME} SHARED ${PROJECT_SOURCES_FILES})

## END BINARY SETTINGS



## LIBRARY SETTINGS

TARGET_LINK_LIBRARIES(${CMAKE_PROJECT_NAME}
    ${OPENGL_LIBRARIES}
    ${GLEW_LIBRARIES}
    ${ASSIMP_LIBRARY}
    ${LOG4CPP_LIBRARY}
    ${DevIL_LIBRARY_ILUT}
    ${DevIL_LIBRARY_ILU}
    ${DevIL_LIBRARY_IL}
    )

## END LIBRARY SETTINGS



## INSTALLATION SETTINGS

INSTALL(TARGETS ${CMAKE_PROJECT_NAME}
    RUNTIME DESTINATION bin
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib)

INSTALL(FILES ${ENGINE_HEADERS_FILES}
    DESTINATION include/Engine/
    )

INSTALL(FILES ${CORE_ENGINE_HEADERS_FILES}
    DESTINATION include/Engine/Core/
    )


## END INSTALLATION SETTINGS



## DOXYGEN CONFIGURATION

FIND_PACKAGE(Doxygen QUIET)

IF (DOXYGEN_FOUND)

    CONFIGURE_FILE(
        ${CMAKE_SOURCE_DIR}/Doxyfile.in
        ${CMAKE_BINARY_DIR}/Doxyfile
        @ONLY)

    ADD_CUSTOM_TARGET(doc
        ${DOXYGEN_EXECUTABLE} ${CMAKE_BINARY_DIR}/Doxyfile
        WORKING_DIRECTORY "${CMAKE_SOURCE_DIR}/sources"
        COMMENT "Generating API documentation with Doxygen" VERBATIM
        )

ENDIF (DOXYGEN_FOUND)

## END DOXYGEN CONFIGURATION
